package CS6350HW1.hw1;

import java.net.URL;
import java.nio.channels.Channels;
import java.nio.channels.ReadableByteChannel;
import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.fs.FileSystem;
import org.apache.hadoop.fs.Path;

import java.io.*;
import java.net.*;
import org.apache.hadoop.conf.*;
import org.apache.hadoop.fs.*;
import org.apache.hadoop.io.*;
import org.apache.hadoop.util.*;

public class App {

	public static void main(String[] args) throws IOException {
		
		//Only used 1 file for testing, will include others later
		
		//Downloading the Files from website
		URL website = new URL("http://www.utdallas.edu/~axn112530/cs6350/lab2/input/20417.txt.bz2");
		ReadableByteChannel rbc = Channels.newChannel(website.openStream());
		FileOutputStream fos = new FileOutputStream("file1.txt.bz2");
		fos.getChannel().transferFrom(rbc, 0, Long.MAX_VALUE);
		fos.close();
		
		//Set copy path
		String local = "/home/010/s/sx/sxc162331/file1.txt.bz2";
		String dst = "hdfs://cshadoop1/user/sxc162331/assignment1/";
		
		//Uploading the files from local disk to HDFS
		Configuration config = new Configuration();
		System.out.println("Connecting to --"+config.get("fs.defaultFS"));
		config.set("fs.defaultFS",dst);
		FileSystem fs = FileSystem.get(config);
		fs.copyFromLocalFile(new Path(local),new Path(dst));
		
	}
}
